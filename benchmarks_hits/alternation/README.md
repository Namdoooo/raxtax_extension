# Benchmark: Complementation

## Purpose
This benchmark evaluates how well the extended raxtax workflow handles
queries with unknown orientation. The objective of this benchmark is 
to assess whether the method can correctly classify disoriented queries 
and to compare the resulting classification accuracy to the case where 
all queries share the same orientation as the reference database.

## Benchmark Design
The benchmark is organized into 30 independent iterations. In each
iteration, a paired experiment is conducted using the same reference
database and the same set of query sequences.

For each iteration:
- the classification is executed once with oriented queries
- the same queries are executed again in disoriented form

All parameters remain identical across iterations and between the two
conditions within an iteration. The only difference between the paired
tests is the orientation of the query sequences.

## Data Generation
All input data used in this benchmark is generated automatically by the
benchmark scripts. No external input data is required.

For each iteration, a new dataset is generated using random seeds. The
same reference database and query sequences are used for both the
oriented and disoriented runs within an iteration.

## Execution workflow
The benchmark execution is organized in multiple layers.

The `main.py` file in the benchmark root directory orchestrates the
execution of all iterations. For each iteration, it invokes the
corresponding `main.py` located in the iteration subdirectory.

Each iteration directory contains its own `main.py`, which is identical
across all iterations and executes the paired tests for that iteration.

For each test, the iteration-level `main.py` performs the following steps:

1. Generates a configuration file and an executable to run the simulation.
2. Executes the simulation using the generated executable and configuration file.
3. Generates the input data based on the configuration file.
4. Executes the classification algorithm (raxtax extension) on the 
   generated input data.

## How to Run
From the raxtax root directory, execute:

```
python -m benchmarks_hits.alternation.main
```

After completion, analysis and plotting can be performed with:

```
python -m benchmarks_hits.alternation.analyze
```

If the benchmarks `alternation_m004` and `alternation_m008` have also
been executed and are located in the same parent directory, an
additional comparative analysis can be performed with:

```
python -m benchmarks_hits.alternation.analyze_mutation_rate
```

Similarly, if the benchmarks alternation_t003 and alternation_t017
have been executed and are located in the same parent directory, the
following script can be used to perform a comparative analysis with
respect to tree height:

```
python -m benchmarks_hits.alternation.analyze_tree_height
```

## Output

### Per test (within each iteration)
For each test run, the following directories and files are generated:

- `queries/`  
  Contains the generated query sequences used as input for the
  classification algorithm. This directory also includes intermediate
  files and log files produced during query generation.
- `references/`  
  Contains the generated reference data used for classification. This
  directory also includes intermediate files, log files, and a lookup
  table required by the classification algorithm.
- `results_*/`  
  Contains the classification results and a `metadata.out` file containing
  runtime measurements and classification statistics.

For archival purposes, the `queries/` and `references/` directories
generated by the benchmark were manually zipped together as
`dataset.tgz` to reduce storage requirements.

### After analysis
After executing the analysis scripts (`analyze.py`, `analyze_mutation_rate.py`, `analyze_tree_height.py`), 
the following additional output files are generated:

- `aggregated_metadata.csv`  
  Aggregated metadata for all tests within a single iteration.
- `combined_metadata.csv`  
  Aggregated metadata across all iterations.
- `significance_test.tsv`
  Contains the results of the Wilcoxon signed-rank test and effect size.
- `alternation_box_plot.pdf`  
  Boxplot showing comparison between oriented and disoriented queries.
- `alternation_mutation_rate_box_plot.pdf`
  Grouped boxplot showing comparison between oriented and disoriented queries
  for different substitution rates (mutation rates).
- `alternation_tree_height_box_plot.pdf`
  Grouped boxplot showing comparison between oriented and disoriented queries
  for different average branch lengths (tree heights).  

## Notes

The benchmark was executed using commit `daa97cdda2e094564233d27a4cb0500bc9d1d57e` of the `raxtax_extension`
repository.

